extends ./template.pug

block content
	.row
		.col-md-12
			.card
				.card-header
					h4.card-title Payments
				.card-body
					.toolbar
						button.btn.btn-round.btn-success(data-toggle='modal' data-target='#addPaymentModal') + Add Payment
					br
					table#stallTable.table.table-bordered.table-striped(cellspacing='0')
						thead
							tr
								th Reference Number
								th Payment Date
								th Amount Paid
								th Actions
						tbody
							tr
								td hello
								td hello
								td hello
								td hello
	#addPaymentModal.modal.fade(tabindex='-1', role='dialog', aria-hidden='true')
		.modal-dialog(role='document')
			.modal-content
				.modal-header
					h5.modal-title Add Payment
					button.close(type='button', data-dismiss='modal', aria-label='Close')
						span(aria-hidden='true') Ã—
				form#addPaymentForm
					.modal-body#addPaymentModalBody
						.form-group
							label Pay for:
								small.text-danger  *
							br
							select.form-control.selectpicker.paymentFor(data-style='select-with-transition btn-primary btn-round' title='Select')
								option(value='W') Water Bill
								option(value='E') Electricity Bill
								option(value='R') Rental Bill
							label Bill Code
								small.text-danger  *
							input.form-control.billCode(type="text" placeholder="Enter Bill Code")
							label Amount Paid
								small.text-danger  *
							input.form-control.amountPaid(type="number" placeholder="Enter Amount Paid")
					.modal-footer
						button#addPaymentSave.btn.btn-primary(type='submit') Save
						button#addPaymentButton.btn.btn-success + Another Bill
block contentScript
	script.
		$(document).ready(function(){
			$('#stallTable').dataTable()
			$('#addPaymentButton').on('click', function(){
				$('#addPaymentModalBody').append(`<div class="form-group">
						<label>Pay for:<small class="text-danger"> *</small></label><br />
						<select class="form-control selectpicker paymentFor" data-style="select-with-transition btn-primary btn-round" title="Select">
							<option value="W">Water Bill
							<option value="E">Electricity Bill</option>
							<option value="R">Rental Bill</option>
						</select>
						<label>Bill Code<small class="text-danger"> *</small></label>
						<input class="form-control billCode" type="text" placeholder="Enter Bill Code" />
						<label>Amount Paid<small class="text-danger"> *</small></label>
						<input class="form-control amountPaid" type="number" placeholder="Enter Amount Paid" />
					</div>`
				)
				$('.selectpicker').selectpicker()
			})
			$('#addPaymentForm').on('submit', function(e){
				e.preventDefault()
			})
			$('#addPaymentSave').on('click', function(){
				const bills = $('.selectpicker')
				const billCodes = $('.billCode')
				const amountPaids = $('.amountPaid')
				const finalInfo = []

				for(let i = 0; i<bills.length; i++){
					finalInfo.push({
						bill: bills.eq(i).val(),
						billCode: billCodes.eq(i).val(),
						amountPaid: amountPaids.eq(i).val()
					})
				}
				console.log(finalInfo)
			})
		})
